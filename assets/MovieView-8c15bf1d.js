import{g as T,_ as L,f as c,o as t,c as s,a as e,b as h,e as g,t as d,F as b,r as y,n as w,h as _}from"./index-0d8c4398.js";import{P as B}from"./Preloader-04f793e1.js";import{P as U,F as C,a as M,b as P,c as Y,d as H,e as N}from"./FaSolidStar-62bfbce6.js";const I=T(),V={components:{Preloader:B,PlayIcon:U,FaRegularBookmark:C,FaRegularHeart:M,FaRegularStar:P,FaSolidBookmark:Y,FaSolidHeart:H,FaSolidStar:N},data(){return{movies:{},loading:!0,imgUrl:null,genres:[],rating:0,radius:30,progressColor:"rgb(63,0,156)",movieId:null,movieTitle:null,showModal:!1,youtubeUrl:null,youtubeId:null,videoData:[],videoNewData:{},movId:null,noResultOrEmpty:!0,hideHeartSolid:!0,hideBookmarkSolid:!0,hideStarSolid:!0,loggedIn:!1}},created(){I.onAuthStateChanged(o=>{this.getWatchlist(o.uid,"watchlist"),this.getFavorite(o.uid,"favorites")}),this.loading=!0,this.fetchInformation(),this.getVideoInfo()},watch:{"$route.params.id"(o){this.loading=!1,this.fetchInformation(),this.getVideoInfo(),I.onAuthStateChanged(a=>{this.getWatchlist(a.uid,"watchlist"),this.getFavorite(a.uid,"favorites")})}},methods:{async fetchInformation(){this.loading=!0,this.movieId=this.$route.params.id,await this.$request.GetRequest(`/movie/${this.movieId}`).then(o=>{const a=o.data;this.imgUrl=this.$formats.concatBGImgUrl(a.backdrop_path),this.rating=a.vote_average.toFixed(1),this.movies=a,this.genres=a.genres}).catch(o=>{o.response.status===404?this.movies=o.response.data:this.error=o}).finally(()=>{this.loading=!1})},async getVideoInfo(){this.movId=this.$route.params.id,await this.$request.GetRequest(`/movie/${this.movId}/videos`).then(o=>{const a=o.data;this.videoData=a.results;const m=this.videoData.filter(r=>r.type==="Trailer").reduce((r,i)=>{const u=new Date(i.published_at);return u>r?u:r});this.videoNewData=m,this.youtubeUrl=`https://www.youtube.com/embed/${this.videoNewData.key}`,this.youtubeId=this.videoNewData.key,this.showModal=!0,this.noResultOrEmpty=!1}).catch(o=>{console.log(o),this.noResultOrEmpty=!0}).finally(()=>{this.loading=!1})},emptyYoutubeUrl(){this.youtubeUrl="",this.showModal=!1},toggle(o){o===1?this.$firebase.state.user!==null&&(this.hideHeartSolid?(this.hideHeartSolid=!1,this.addTo("favorites")):(this.hideHeartSolid=!0,this.deleteFrom("favorites"))):o===2?this.$firebase.state.user!==null&&(this.hideBookmarkSolid?(this.hideBookmarkSolid=!1,this.addTo("watchlist")):(this.hideBookmarkSolid=!0,this.deleteFrom("watchlist"))):this.$firebase.state.user!==null&&(this.hideStarSolid?this.hideStarSolid=!1:this.hideStarSolid=!0)},async addTo(o){const l={movie_id:this.movieId,movie_title:this.movies.title,movie_poster:this.PosterPath,user_id:this.$firebase.state.user.uid};o=="watchlist"?await this.$firebase.addWatchlists("users",l):await this.$firebase.addFavorites("users",l)},async deleteFrom(o){o=="watchlist"?await this.$firebase.deleteWatchlist("users",this.$firebase.state.user.uid):await this.$firebase.deleteFavorite("users",this.$firebase.state.user.uid)},async getWatchlist(o){const l={movie_id:this.movieId,user_id:o};await this.$firebase.getWatchlists("users",l),this.$firebase.state.watchlist!==null?this.hideBookmarkSolid=!1:this.hideBookmarkSolid=!0},async getFavorite(o){const l={movie_id:this.movieId,user_id:o};await this.$firebase.getFavorites("users",l),this.$firebase.state.favorites!==null?this.hideHeartSolid=!1:this.hideHeartSolid=!0}},computed:{isLoggedIn(){return this.$firebase.state.user!==null},sanitizeTitle:function(){return this.movieTitle=this.movieTitle.replace(/-/g,"%"),this.movieTitle},circumference(){return 2*Math.PI*(this.radius/10*100)},progressOffset(){return this.circumference*(1-this.rating/100)},progressColor(){return this.rating>7?"#4caf50":this.rating>5?"#ffc107":"#f44336"},formattedNames(){return this.genres.map((o,a)=>{const l=o.name.split(", ");return a===this.genres.length-1?`${l[0]} ${l.slice(1).join(" ")}`:`${l[0]}, ${l.slice(1).join(" ")}`})},PosterPath(){return this.$formats.concatImgUrl(this.movies.poster_path)},ReleasedYear(){return this.$formats.getYear(this.movies.release_date)},ReleaseDate(){return this.$formats.getFormatDate(this.movies.release_date,!0)},MovieRuntime(){return this.$formats.getDuration(this.movies.runtime)}}},O={key:0,class:"preloader"},W=e("h1",null,"No Records Found",-1),E=[W],j={key:1},q={key:0},A={class:"preloader"},G={key:1},z={class:"details-container custom_bg"},J={class:"single-column"},K={class:"inner"},Q={class:"poster_wrapper"},X={class:"poster"},Z=["src","alt"],$={class:"movie_information_wrapper"},ee={class:"title-header"},te={class:"title"},se={class:"muted"},ie={class:"sub-title"},oe={class:"actions"},ae={class:"action-item"},re={class:"progress-chart-container"},le={class:"progress-chart-wrapper"},ne={class:"progress-chart-circle"},de=["r"],ce=["r"],he={class:"progress-chart-text"},_e=e("span",null,"User Score",-1),ue={class:"action-item"},ge={class:"c-tooltip"},me=["data-bs-toggle","data-bs-target"],fe={key:0},ve={key:1},ke={key:0,class:"tooltiptext"},pe={key:0},be={key:1},ye={key:1,class:"tooltiptext"},we={key:0},Ie={key:1},Se={class:"action-item"},Fe={class:"c-tooltip"},Re=["data-bs-toggle","data-bs-target"],xe={key:0},De={key:0},Te={key:1},Le={key:1},Be={key:0},Ue={key:1},Ce={key:0,class:"tooltiptext"},Me={key:0},Pe={key:1},Ye={key:1,class:"tooltiptext"},He={key:0},Ne={key:1},Ve={class:"action-item"},Oe={class:"c-tooltip"},We=["data-bs-toggle","data-bs-target"],Ee={class:"tooltiptext"},je={key:0},qe={key:1},Ae={class:"action-item"},Ge={key:0},ze=["href"],Je={class:"play-icon"},Ke=e("span",null,"Play Trailer",-1),Qe={class:"tagline"},Xe={class:"overview"},Ze=e("div",{class:"overview-title"}," Overview ",-1),$e={class:"overview-info"},et={class:"modal fade",id:"movieTrailer","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"movieTrailerLabel","aria-hidden":"true"},tt={class:"modal-dialog modal-dialog-centered border-none modal-xl"},st={class:"modal-content border-0 shadow-lg"},it={class:"modal-body"},ot={key:0},at={class:"preloader"},rt={key:1},lt={class:"ratio ratio-16x9"},nt=["src"],dt={class:"modal-footer bg-dark d-flex justify-content-center align-items-center"};function ct(o,a,l,m,r,i){const u=c("preloader"),f=c("fa-regular-heart"),v=c("fa-solid-heart"),k=c("fa-regular-bookmark"),p=c("fa-solid-bookmark"),F=c("fa-regular-star"),R=c("fa-solid-star"),x=c("play-icon");return r.movies.success==!1?(t(),s("div",O,E)):(t(),s("div",j,[r.loading?(t(),s("div",q,[e("div",A,[h(u)])])):(t(),s("div",G,[e("div",{class:"head large first",style:w({"--image-url":"url("+r.imgUrl+")"})},[e("div",z,[e("div",J,[e("section",K,[e("div",Q,[e("div",X,[e("img",{src:i.PosterPath,alt:r.movies.title,class:"image-content"},null,8,Z)])]),e("div",$,[e("div",ee,[e("div",te,[g(d(r.movies.title)+" ",1),e("span",se,"("+d(i.ReleasedYear)+")",1)]),e("div",ie,[g(d(i.ReleaseDate)+" ",1),(t(!0),s(b,null,y(r.movies.production_countries,(n,D)=>(t(),s("span",{key:D},d(n.iso_3166_1+" "),1))),128)),g(" • "),(t(!0),s(b,null,y(i.formattedNames,n=>(t(),s("span",{key:n},d(n),1))),128)),g(" • "+d(i.MovieRuntime),1)])]),e("ul",oe,[e("li",ae,[e("div",re,[e("div",le,[(t(),s("svg",ne,[e("circle",{class:"progress-chart-progress",style:w({strokeDasharray:i.circumference,strokeDashoffset:i.progressOffset,stroke:i.progressColor}),cx:"50%",cy:"50%",r:r.radius,"stroke-width":"10",fill:"none"},null,12,de),e("circle",{class:"progress-chart-background",cx:"50%",cy:"50%",r:r.radius,"stroke-width":"5",fill:"none"},null,8,ce)])),e("div",he,d(r.rating),1)])]),_e]),e("li",ue,[e("div",ge,[e("a",{href:"#",class:"c-btn c-btn-link","data-bs-toggle":i.isLoggedIn?"":"modal","data-bs-target":i.isLoggedIn?"":"#loginModal",onClick:a[0]||(a[0]=n=>i.toggle(1))},[r.hideHeartSolid&&!i.isLoggedIn?(t(),s("span",fe,[this.$firebase.state.favorites!=this.movieId?(t(),_(f,{key:0,class:"svg-link"})):(t(),_(v,{key:1,class:"svg-link"}))])):(t(),s("span",ve,[this.$firebase.state.favorites==this.movieId?(t(),_(v,{key:0,class:"svg-link"})):(t(),_(f,{key:1,class:"svg-link"}))]))],8,me),r.hideHeartSolid&&this.$firebase.state.favorites!=this.movieId?(t(),s("span",ke,[i.isLoggedIn?(t(),s("span",pe," Mark as favorite ")):(t(),s("span",be," You need to login "))])):(t(),s("span",ye,[i.isLoggedIn?(t(),s("span",we," Unmark as favorite ")):(t(),s("span",Ie," You need to login "))]))])]),e("li",Se,[e("div",Fe,[e("a",{href:"#",class:"c-btn c-btn-link","data-bs-toggle":i.isLoggedIn?"":"modal","data-bs-target":i.isLoggedIn?"":"#loginModal",onClick:a[1]||(a[1]=n=>i.toggle(2))},[r.hideBookmarkSolid&&!i.isLoggedIn?(t(),s("span",xe,[this.$firebase.state.watchlist!=this.movieId?(t(),s("span",De,[h(k,{class:"svg-link"})])):(t(),s("span",Te,[h(p,{class:"svg-link"})]))])):(t(),s("span",Le,[this.$firebase.state.watchlist!=this.movieId?(t(),s("span",Be,[h(k,{class:"svg-link"})])):(t(),s("span",Ue,[h(p,{class:"svg-link"})]))]))],8,Re),r.hideBookmarkSolid&&this.$firebase.state.watchlist!=this.movieId?(t(),s("span",Ce,[i.isLoggedIn?(t(),s("span",Me," Add to your watchlist ")):(t(),s("span",Pe," You need to login "))])):(t(),s("span",Ye,[i.isLoggedIn?(t(),s("span",He," Remove to your watchlist ")):(t(),s("span",Ne," You need to login "))]))])]),e("li",Ve,[e("div",Oe,[e("a",{href:"#",class:"c-btn c-btn-link","data-bs-toggle":i.isLoggedIn?"":"modal","data-bs-target":i.isLoggedIn?"":"#loginModal",onClick:a[2]||(a[2]=n=>i.toggle(3))},[r.hideStarSolid?(t(),_(F,{key:0,class:"svg-link"})):(t(),_(R,{key:1,class:"svg-link"}))],8,We),e("span",Ee,[i.isLoggedIn?(t(),s("span",je," Rate It! ")):(t(),s("span",qe," You need to login "))])])]),e("li",Ae,[r.noResultOrEmpty?(t(),s("span",Ge)):(t(),s("a",{key:1,href:`_#${this.youtubeId}`,"data-bs-toggle":"modal","data-bs-target":"#movieTrailer",onClick:a[3]||(a[3]=(...n)=>i.getVideoInfo&&i.getVideoInfo(...n)),class:"play-trailer"},[e("span",Je,[h(x)]),Ke],8,ze))])]),e("div",Qe,[e("i",null,d(r.movies.tagline),1)]),e("div",Xe,[Ze,e("div",$e,d(r.movies.overview),1)])])])])])],4),e("div",et,[e("div",tt,[e("div",st,[e("div",it,[r.loading?(t(),s("div",ot,[e("div",at,[h(u)])])):(t(),s("div",rt,[e("div",lt,[e("iframe",{src:r.youtubeUrl,title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,8,nt)])]))]),e("div",dt,[e("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal","aria-label":"Close",onClick:a[4]||(a[4]=(...n)=>i.emptyYoutubeUrl&&i.emptyYoutubeUrl(...n))},"Close")])])])])]))]))}const S=L(V,[["render",ct]]),ht={components:{MovieDetails:S}},mt=Object.assign(ht,{__name:"MovieView",setup(o){return(a,l)=>(t(),s("main",null,[h(S)]))}});export{mt as default};
